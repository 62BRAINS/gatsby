const fs = require("fs")
const path = require("path")
const yaml = require(`js-yaml`)
const unified = require("unified")

const authorNames = yaml
  .load(fs.readFileSync("./docs/blog/author.yaml"))
  .flatMap(author => author.id.split(" "))

const packages = fs
  .readdirSync("./packages")
  .filter(f => fs.statSync(path.join("./packages", f)).isDirectory())

const words = [
  ...authorNames,
  ...packages,
  "➡️",
  "90s",
  "3G",
  "async",
  "addon", //also add-on
  "arg",
  "args",
  "addons", //also add-on
  "analytics",
  "anonymized",
  "architecting",
  "auth",
  "autoplay",
  "autoplaying",
  "autocomplete",
  "backend",
  "backends",
  "backtick",
  "backticks",
  "barebones",
  "blockquote",
  "blockquotes",
  "blogpost", // used in source-plugin-tutorial; should just be "blog post"?
  "bugfixes", // bug fixes?
  "changelog",
  "cheatsheet",
  "colocate",
  "codebase", // we're inconsistent about codebase vs code base
  "codebases",
  "codecs",
  "config",
  "configs",
  "codemod",
  "customizable",
  "customizations",
  "Ctrl",
  "dataset",
  "destructure",
  "destructured",
  "deprecation",
  "deprecations",
  "dev",
  "distro",
  "distros",
  "discoverable",
  "discoverability",
  "dropdown",
  "duotone",
  "ecommerce",
  "env",
  "favicon",
  "filesystem",
  "formatter",
  "frontend",
  "frontends",
  "frontmatter",
  "full-throated",
  "Gatsbygram",
  "globals",
  "grayscale",
  "hackathon",
  "hardcode",
  "hardcoded",
  "hardcoding",
  "implementer",
  "implementers",
  "indexable",
  "inlined",
  "inlining",
  "installable",
  "integrations",
  "JSX",
  "JSON-LD",
  "lifecycle",
  "lifecycles",
  "livestream",
  "livestreams",
  "matchers",
  "minimalistic",
  "minified",
  "minifies",
  "minification",
  "misconfigured",
  "modularize",
  "modularizing",
  "modularity",
  "multithreading",
  "namespace",
  "namespaces",
  "namespaced",
  "natively",
  "nav",
  "navigations",
  "onboarding",
  "parsers",
  "pathname",
  "pathnames",
  "performant",
  "presentational",
  "preload",
  "prepend",
  "prepends",
  "preprocessor",
  "prefetching",
  "pre-loading",
  "pre-existing",
  "pre-release",
  "pre-filled",
  "pre-cache",
  "pre-caching",
  "pre-fetching",
  "pre-optimize",
  "pre-installed", // apparently preinstalled is better?
  "pre-configured", // also preconfigured
  "pre-compiled",
  "preconfigured", // also preconfigured
  "pre-bundle", // hypax
  "pre-built",
  "pre-fill",
  "preloading",
  "programmatically",
  "profiler",
  "pullquotes",
  "polyfill",
  "polyfills",
  "quickstart",
  "queryable",
  "uncomment",
  "unoptimized",
  "unvisited",
  "unmount",
  "unmounting",
  "README",
  "rerender",
  "renderers",
  "rehydrate",
  "rehydrates",
  "rehydrated",
  "rehydration",
  "repo",
  "repos",
  "reconciler",
  "resolvers",
  "reusability",
  "roadmap",
  "scalable",
  "schema",
  "scaffolded",
  "schemas",
  "semver",
  "serializer",
  "serializers",
  "signups",
  "shadowable",
  "shortcode",
  "shortcodes",
  "stringified",
  "stylings",
  "stylesheet", // should be style sheet?
  "stylesheets",
  "superset",
  "subfolder",
  "subobject",
  "subobject's",
  "subpages",
  "subcomponents",
  "subdirectory",
  "subfield",
  "subfields",
  "syntaxes",
  "theming",
  "templating",
  "timeframe",
  "timeframes",
  "toolset",
  "transpile",
  "transpiles",
  "transpiled",
  "transpiler",
  "tradeoffs", // also trade-offs
  "viewport",
  "webpages",
  "webhook",
  "webhooks",
  "websocket",
  "walkthrough",
  "workspace",
  "workspaces",
  "hoo", // part of "woo hoo"
  "yay",
  "c'mon",
  "tada",

  // Abbreviations
  "JSON",
  "YAML",
  "URI",
  "MDX",
  "MDN",
  "MDN's",
  "OWASP",
  "CSRF",
  "a11y",
  "LTS",
  "API",
  "APIs",
  "CDATA",
  "AST",
  "UUID",
  "UUIDs",
  "CLI",
  "CSV",
  "CMS",
  "CMSs",
  "CMSes",
  "CSS-in-JS",
  "CaaS",
  "DevOps",
  "SCSS",
  "DNS",
  "DOM",
  "GIFs",
  "CDN",
  "PWA",
  "PWAs",
  "PCI",
  "SaaS",
  "i18n",
  "ROI",
  "CSP",
  "SSR",
  "SEO",
  "SKU",
  "SKUs",
  "SSL",
  "SVG",
  "UI",
  "UIs",
  "UX",
  "VM",
  "KV",
  "SMT",
  "TXT",
  "DX",
  "GUID",
  "HTML5",
  "HTTPS",
  "PRPL",
  "RSS",
  "XSS",
  "JS",
  "GQL",
  "HOC",
  "HOCs",

  // People names
  "Chedeau's",
  "Dalgleish's",
  "Ngo's",
  "Lengstorf",
  "Otander",
  "Zhu",
  "Wedekind",
  "Dodds",
  "Kalin",
  "Chernev",
  "Biscardi",
  "Berriman",
  "Soper",
  "Gienow",
  "Schau",
  "Schau's",
  "Amberley",
  "Romo",
  "Eka",
  "Fujihara",
  "Bhagwat's",
  "Addy",
  "Osmani",
  "Berners-Lee",

  // Brand/product/library names
  "react-intl",
  "react-intl's",
  "i18next",
  "W3C",
  "W3C's",
  "oEmbed",
  "devcert",
  "CodeSandbox",
  "EC2",
  "PokéAPI",
  "Prismic",
  "Prisma",
  "Prisma's",
  "Pokémon",
  "WebStorm",
  "VSCode",
  "BuilderIO",
  "ButterCMS",
  "Filestack",
  "Contentstack",
  "axios",
  "Moz",
  "Vercel",
  "Cloudflare",
  "Styleguidist",
  "Airtable",
  "jQuery",
  "Gitter",
  "Contentful",
  "OpenTracing",
  "Jaeger",
  "Zipkin",
  "Kentico",
  "Kontent",
  "dotenv",
  "ReactDOM",
  "ReactDOMServer",
  "CircleCI",
  "Docz",
  "GitLab",
  "PrismJS",
  "Gentics",
  "ES6",
  "Bing",
  "Funston",
  "GraphiQL",
  "GraphQL",
  "npm",
  "npx",
  "lodash",
  "lodash's",
  "TopoJSON",
  "OpenAI",
  "Unsplash",
  "Vimeo",
  "Auth0",
  "Egghead.io",
  "JAMstack",
  "JAMStack", // we're inconsistent
  "OAuth",
  "zsh",
  "Netlify",
  "Netlify's",
  "Node.js",
  "PDFs",
  "JSON",
  "YAML",
  "MDX",
  "MDN",
  "MDN's",
  "Node.js's",
  "GraphCMS",
  "Hasura",
  "AppSync",
  "Dgraph",
  "WooCommerce",
  "WPGraphQL",
  "Codecademy",
  "CommonJS",
  "DevTools",
  "Housecall",
  "Homebrew",
  "JSS",
  "PostCSS",
  "macOS",
  "MacOS",
  "Linux",
  "Manjaro",
  "Typography.js",
  "nvm",
  "Xcode",
  "Stripe.js",
  "Snipcart",
  "Bitbucket",
  "Shopify",
  "DatoCMS",
  "Zuri",
  "webpack",
  "redux",
  "WebP",
  "Youfit",
  "Akamai",
  "Cloudinary",
  "PurgeCSS",
  "glamor",
  "Etsy",
  "Etsy's",
  "S3",
  "Cloudfront",
  "KintoHub",
  "Imgur",
  "PayPal",
  "Reddit",
  "Udacity",
  "ESLint",
  "WebAIM",
  "Deque",
  "IndexedDB",
  "FormatJS",
  "WebGL",
  "Mediacurrent",
  "Mediacurrent's",
  "axe",

  // MDX
  "EmailCaptureForm",

  // plugin names -- should these be backticked?
  "eslint-plugin-jsx-a11y",
  "react-konva",
  "graphql-js",
  "netlify-cli",
  "wp-graphql",
  "mdast",
  "unist",
  "unist-util-visit",
  "mdast-util-to-string",
  "babel-preset-gatsby",
  "wp-graphql-woocommerce",
  "react-fontawesome",
  "react-gif-player",
  "react-intl",
  "react-i18next",
  "gatsby-plugin-i18n",
  "gatsby-plugin-csp",
  "gatsby-image's",
  "gatsby-plugin-netlify",
  "gatsby-plugin-create-client-paths",
  "gatsby-plugin-remove-trailing-slashes",
  "gatsby-transformer-sharp",
  "gatsby-starter-default",
  "gatsby-starter-netlify-cms",
  "gatsby-starter-prismic",
  "gatsby-starter-blog",
  "gatsby-starter-ecommerce",
  "gatsby-starter-stripe",
  "gatsby-plugin-sass",
  "gatsby-plugin-styled-components",
  "gatsby-personal-starter-blog",
  "gatsby-source-filesystem",
  "gatsby-source-contentful",
  "gatsby-source-wordpress",
  "gatsby-source-cloudinary",
  "gatsby-transformer-yaml",
  "gatsby-transformer-cloudinary",
  "gatsby-transformer-remark",
  "gatsby-transformer-plugin",
  "gatsby-plugin-theme-ui",
  "gatsby-plugin-manifest",
  "gatsby-plugin-offline",
  "gatsby-plugin-layout",
  "gatsby-plugin-mdx",
  "gatsby-source-graphql",
  "gatsby-source-x-cms",
  "gatsby-plugin-postcss",
  "gatsby-mdx-embed",
  "gatsby-theme-notes",
  "gatsby-theme-starter",
  "gatsby-theme-blog",
  "gatsby-source-stripe",

  // parts of the API that we should backtick
  "onCreateNode",
  "createNode",
  "createNodeField",
  "nodeId",
  "NodeID",
  "createContentDigest",
  "createRemoteFileNode",
  "wrapPageElement",
  "WeakMap",
  "GqlType",

  // questionable?
  "touchNode",
  "createPageDependency",
  "getNodeAndSavePathDependency",
  "findIdsWithoutDataDependencies",
  ".babelrc",
  "v4",
  "v3",
  "v2",
  "v1",
  "v0",
  "onPreRouteUpdate",
  "onRouteUpdate",
  "RootQueryType",
  "graphql",
  "h1",
  "h1s",
  "h2",
  "devDependencies",
  "HashHistory",
  "hashrouter",
  "browserrouter",
  "src",
  "onCreatePage",
  "SitePlugin",
  "SitePage",
  "traceID",
  "resave",
  "gatsbyjs.org's",
  // hashtags -- can use another plugin to treat them like such
  "gatsbytutorial",
  "buildwithgatsby",
  "gatsbyjs",
  "QL",
  "rhodochrosite",
  "eBook", // e-book?
  "1px",
  "404s",
  "400px",
  "250px",
  "100ms",
  "5X",
  "2x",
  "2-3x",
  "10x",
  "100K",
  "useStaticQuery",
  "StaticQuery", // should be backticked
  "gqlType",
  "gqlTypes",
  "re-engageable",
  "linkable",
  "filepath",
].join("\n")

module.exports = {
  plugins: [
    ["remark-frontmatter", "yaml"],
    [
      "remark-retext",
      unified()
        .use(require("retext-english"))
        .use(require("retext-syntax-urls"))
        .use(require("retext-syntax-mentions"))
        .use(require("retext-spell"), {
          dictionary: require("dictionary-en"),
          personal: words,
        })
        .use(require("retext-diacritics"))
        .use(require("retext-indefinite-article"))
        .use(require("retext-redundant-acronyms"))
        .use(require("retext-sentence-spacing")),
    ],
    "remark-preset-lint-recommended",
    "remark-preset-lint-markdown-style-guide",

    // additional remark-lint rules
    ["remark-lint-list-item-indent", "space"],
    "remark-lint-no-duplicate-headings-in-section",
    "remark-lint-no-reference-like-url",
    ["remark-lint-ordered-list-marker-value", "ordered"],

    // We would like these rules to be enabled, but they require significant content changes
    // and need additional PRs to be implemented
    ["remark-lint-emphasis-marker", false],
    ["remark-lint-heading-increment", false],
    ["remark-lint-no-heading-punctuation", false],
    ["remark-lint-list-item-spacing", false],

    // The following rules are disabled because they are inconsistent to the
    // Gatsby Style Guide.

    // We use soft-wrapped paragraphs for ease of diffing/translation.
    ["remark-lint-maximum-line-length", false],
    // We don't restrict the length of headings.
    ["remark-lint-maximum-heading-length", false],
    // We use duplicate headings sometimes, e.g. multiple "Directions" in Recipes.
    // Use no-duplicate-headings-in-section instead.
    ["remark-lint-no-duplicate-headings", false],
    // We use emphasis as notes or warnings in a couple places, which triggers this rule.
    ["remark-lint-no-emphasis-as-heading", false],
    // YouTube and Giphy embeds in the docs use literal URLs.
    ["remark-lint-no-literal-urls", false],
    // We use `[shortcuts]` for convenience.
    ["remark-lint-no-shortcut-reference-link", false],
    // We use brackets in a lot of places as argument lists and do not want to escape them.
    ["remark-lint-no-undefined-references", false],
    ["remark-lint-first-heading-level", 2],
  ],
}
